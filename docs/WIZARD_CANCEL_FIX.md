# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–º–µ–Ω—ã wizard'–æ–≤ –Ω–∞ –ª—é–±–æ–º —à–∞–≥–µ

## –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥–ª–∏ –ø—Ä–µ—Ä–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (`/add_project`) –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (`/edit_project`) –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —à–∞–≥–∞—Ö —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã `/cancel`.

### –ü—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã:

1. **–§–∏–ª—å—Ç—Ä –∫–æ–º–∞–Ω–¥ –≤ ConversationHandler**: –í `bot.py` —Å–æ—Å—Ç–æ—è–Ω–∏—è wizard'–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ñ–∏–ª—å—Ç—Ä `filters.TEXT & (~filters.COMMAND)`, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–∫–ª—é—á–∞–ª –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã, –≤–∫–ª—é—á–∞—è `/cancel`. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–ª–æ, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ `/cancel` –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞—Å—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞.

2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ /cancel –≤ wizard'–∞—Ö**: –í –º–µ—Ç–æ–¥–∞—Ö `receive_*` –æ–±–æ–∏—Ö wizard'–æ–≤ –Ω–µ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –∫–æ–º–∞–Ω–¥—É `/cancel`.

3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: –í —Å–æ–æ–±—â–µ–Ω–∏—è—Ö wizard'–æ–≤ –Ω–µ –±—ã–ª–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–æ–º, —á—Ç–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `/cancel` –¥–ª—è –æ—Ç–º–µ–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–∏.

## –†–µ—à–µ–Ω–∏–µ

### 1. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `bot.py`

–£–¥–∞–ª–∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä `(~filters.COMMAND)` –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º –≤–≤–æ–¥–æ–º, —á—Ç–æ–±—ã –∫–æ–º–∞–Ω–¥—ã –º–æ–≥–ª–∏ –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã:

**–î–æ:**
```python
WAITING_NAME: [MessageHandler(filters.TEXT & (~filters.COMMAND), self.add_project_wizard.receive_name)]
```

**–ü–æ—Å–ª–µ:**
```python
WAITING_NAME: [MessageHandler(filters.TEXT, self.add_project_wizard.receive_name)]
```

–≠—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ –¥–ª—è –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º –≤–≤–æ–¥–æ–º:
- `WAITING_NAME`
- `WAITING_GIT_URL`
- `WAITING_PROJECT_FILE_PATH`
- `WAITING_DEV_BRANCH`
- `WAITING_RELEASE_BRANCH`
- `EDIT_VALUE`

### 2. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `add_project_wizard.py`

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ–º–∞–Ω–¥—É `/cancel` –≤–æ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–∞—Ö –ø—Ä–∏—ë–º–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞:

```python
async def receive_name(self, update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    """Receive project name and ask for project type."""
    name = update.effective_message.text.strip()

    # Allow cancellation at any point
    if name == "/cancel":
        return await self.cancel(update, context)

    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞
```

–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤:
- `receive_name()`
- `receive_git_url()`
- `receive_project_file_path()`
- `receive_dev_branch()`
- `receive_release_branch()`

–¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–º–µ–Ω—ã:

```python
msg = (
    "üìù *–®–∞–≥ 1 –∏–∑ 6: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞*\n\n"
    "–í–≤–µ–¥–∏—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞\\.\n"
    "–ù–∞–ø—Ä–∏–º–µ—Ä: `MyApp`, `CoolProject`, `EasyBuildBot`\n\n"
    "üí° _–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏ –ø–æ–Ω—è—Ç–Ω—ã–º\\._\n\n"
    "‚ÑπÔ∏è –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /cancel –¥–ª—è –æ—Ç–º–µ–Ω—ã –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç\\."
)
```

### 3. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `edit_project_wizard.py`

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ–º–∞–Ω–¥—É `/cancel` –≤ –º–µ—Ç–æ–¥–µ `receive_value()`:

```python
async def receive_value(self, update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    """Receive new value for the field."""
    text = update.effective_message.text.strip()

    # Allow cancellation at any point
    if text == "/cancel":
        return await self.cancel(update, context)

    if text == "/back":
        return await self.show_field_menu(update, context)

    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞
```

–¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–º–µ–Ω—ã:

```python
msg = (
    f"‚úèÔ∏è *–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—è*\n\n"
    f"*–ü–æ–ª–µ:* {escape_md(label)}\n"
    f"*–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:*\n{escape_md(str(formatted_value))}\n\n"
    f"üí° –í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:\n"
    f"_{escape_md(hint)}_\n\n"
    f"*–ü—Ä–∏–º–µ—Ä:* `{escape_md(example)}`\n\n"
    f"–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ `/back` –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ –º–µ–Ω—é\\.\n"
    f"‚ÑπÔ∏è –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /cancel –¥–ª—è –æ—Ç–º–µ–Ω—ã –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π\\."
)
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –û—Ç–º–µ–Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É `/add_project`
2. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
3. –í–≤–µ–¥–∏—Ç–µ `/cancel`
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞ –∏ –≤—ã–≤–µ–¥–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ: "‚ùå –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –æ—Ç–º–µ–Ω–µ–Ω–æ."

### –¢–µ—Å—Ç 2: –û—Ç–º–µ–Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É `/edit_project`
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
3. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª–µ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
4. –í–≤–µ–¥–∏—Ç–µ `/cancel`
5. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞ –∏ –≤—ã–≤–µ–¥–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ: "‚ùå –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ. –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã."

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—Å–µ—Ö —à–∞–≥–∞—Ö

–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/cancel` –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ wizard'–æ–≤:

**–î–ª—è /add_project:**
- –®–∞–≥ 1: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ ‚Üí `/cancel`
- –®–∞–≥ 3: Git URL ‚Üí `/cancel`
- –®–∞–≥ 4: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –ø—Ä–æ–µ–∫—Ç–∞ ‚Üí `/cancel`
- –®–∞–≥ 5: –í–µ—Ç–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ‚Üí `/cancel`
- –®–∞–≥ 6: –í–µ—Ç–∫–∞ —Ä–µ–ª–∏–∑–∞ ‚Üí `/cancel`

**–î–ª—è /edit_project:**
- –ü—Ä–∏ –≤–≤–æ–¥–µ –Ω–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª—è ‚Üí `/cancel`

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç–µ–ø–µ—Ä—å –º–æ–≥—É—Ç –ø—Ä–µ—Ä–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –ª—é–±–æ–º —à–∞–≥–µ —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã `/cancel`.

‚úÖ –í–æ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö wizard'–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–º–µ–Ω—ã.

‚úÖ –ö–æ–¥ —Å—Ç–∞–ª –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–º –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º KISS –∏ SOLID.

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

- `python/src/easybuild_bot/bot.py` - –∏–∑–º–µ–Ω—ë–Ω —Ñ–∏–ª—å—Ç—Ä –≤ ConversationHandler
- `python/src/easybuild_bot/handlers/add_project_wizard.py` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `/cancel` –∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è
- `python/src/easybuild_bot/handlers/edit_project_wizard.py` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `/cancel` –∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è
