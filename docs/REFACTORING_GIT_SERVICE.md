# –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥: –û–±—â–∏–π GitService –≤–º–µ—Å—Ç–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è

## –î–∞—Ç–∞: 11 –Ω–æ—è–±—Ä—è 2025

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–º–µ—Ç–∏–ª, —á—Ç–æ –ª–æ–≥–∏–∫–∞ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ —Ç—Ä—ë—Ö –º–µ—Å—Ç–∞—Ö:
1. `build_command.py`
2. `project_select_callback.py`
3. `release_wizard.py`

–≠—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—ã:
- **DRY** (Don't Repeat Yourself) - –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–π —Å–µ–±—è
- **SOLID** (Single Responsibility Principle) - –æ–¥–∏–Ω –∫–ª–∞—Å—Å = –æ–¥–Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–°–æ–∑–¥–∞–Ω –æ–±—â–∏–π —Å–µ—Ä–≤–∏—Å `GitService` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏.

### –ù–æ–≤—ã–π —Ñ–∞–π–ª: `services/git_service.py`

–°–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–æ–¥—ã:

#### 1. `clone_repository(project, timeout=300)`
–ö–ª–æ–Ω–∏—Ä—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç.

#### 2. `checkout_branch(repo_path, branch, timeout=30)`
–ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –≤–µ—Ç–∫—É.

#### 3. `pull_branch(repo_path, branch, timeout=120)`
–û–±–Ω–æ–≤–ª—è–µ—Ç –≤–µ—Ç–∫—É –∏–∑ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.

#### 4. `ensure_repository(project)`
**–ì–ª–∞–≤–Ω—ã–π –º–µ—Ç–æ–¥** - –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ:
- –ö–ª–æ–Ω–∏—Ä—É–µ—Ç, –µ—Å–ª–∏ –Ω–µ—Ç
- –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ dev –≤–µ—Ç–∫—É
- –û–±–Ω–æ–≤–ª—è–µ—Ç –≤–µ—Ç–∫—É

## üìä –ë—ã–ª–æ vs –°—Ç–∞–ª–æ

### ‚ùå –ë—ã–ª–æ (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ 3 –º–µ—Å—Ç–∞—Ö):

```python
# –í build_command.py, project_select_callback.py, release_wizard.py
if not os.path.exists(repo_path):
    parent_dir = os.path.dirname(repo_path)
    if parent_dir:
        os.makedirs(parent_dir, exist_ok=True)

    repo_name = os.path.basename(repo_path)

    result = subprocess.run(
        ["git", "clone", project.git_url, repo_name],
        cwd=parent_dir,
        capture_output=True,
        text=True,
        timeout=300
    )

    if result.returncode != 0:
        # ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ ...

    result = subprocess.run(
        ["git", "-C", repo_path, "checkout", project.dev_branch],
        ...
    )
    # ... –∏ —Ç.–¥.
```

### ‚úÖ –°—Ç–∞–ª–æ (–æ–¥–∏–Ω –æ–±—â–∏–π –º–µ—Ç–æ–¥):

```python
# –í build_command.py, project_select_callback.py, release_wizard.py
from ...services import GitService

# –ü—Ä–æ—Å—Ç–æ –æ–¥–∏–Ω –≤—ã–∑–æ–≤!
success, error_msg = GitService.ensure_repository(project)
if not success:
    await ctx.update.effective_message.reply_text(error_msg, parse_mode='Markdown')
    return CommandResult(success=False, error=error_msg)
```

## üéÅ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### 1. **–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã**
- –õ–æ–≥–∏–∫–∞ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤–µ–∑–¥–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### 2. **–õ–µ–≥—á–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å**
- –ú–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å GitService –æ—Ç–¥–µ–ª—å–Ω–æ
- –ù–µ –Ω—É–∂–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç—ã

### 3. **–õ–µ–≥—á–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–æ–≤ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ

### 4. **–ú–µ–Ω—å—à–µ –∫–æ–¥–∞**
- ~50 —Å—Ç—Ä–æ–∫ –≤–º–µ—Å—Ç–æ ~150 (3 —Ä–∞–∑–∞ –ø–æ 50)
- –ß–∏—â–µ –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ

### 5. **–õ—É—á—à–µ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç

### 6. **–°–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º**
- ‚úÖ **S**ingle Responsibility
- ‚úÖ **O**pen/Closed
- ‚úÖ **L**iskov Substitution
- ‚úÖ **I**nterface Segregation
- ‚úÖ **D**ependency Inversion

## üìù –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ë–∞–∑–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

```python
from ...services import GitService

# –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≥–æ—Ç–æ–≤
success, error_msg = GitService.ensure_repository(project)
if not success:
    # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
    await send_message(error_msg)
    return False
```

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π (—Ä—É—á–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å):

```python
from ...services import GitService

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
success, error_msg = GitService.clone_repository(project)
if not success:
    return False

# –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –≤–µ—Ç–∫—É
success, error_msg = GitService.checkout_branch(project.local_repo_path, "feature-branch")
if not success:
    return False

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
success, error_msg = GitService.pull_branch(project.local_repo_path, "feature-branch")
```

## üîß –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. ‚úÖ **–°–æ–∑–¥–∞–Ω:** `services/git_service.py` - –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å
2. ‚úÖ **–°–æ–∑–¥–∞–Ω:** `services/__init__.py` - —ç–∫—Å–ø–æ—Ä—Ç —Å–µ—Ä–≤–∏—Å–∞
3. üîÑ **–û–±–Ω–æ–≤–∏—Ç—å:** `commands/implementations/build_command.py`
4. üîÑ **–û–±–Ω–æ–≤–∏—Ç—å:** `commands/implementations/project_select_callback.py`
5. üîÑ **–û–±–Ω–æ–≤–∏—Ç—å:** `handlers/release_wizard.py`

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –û–±–Ω–æ–≤–∏—Ç—å —Ç—Ä–∏ —Ñ–∞–π–ª–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `GitService`
2. –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞

## üí° –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

–í `GitService` –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å:
- `merge_branches(repo_path, source, target)` - —Å–ª–∏—è–Ω–∏–µ –≤–µ—Ç–æ–∫
- `create_branch(repo_path, branch_name)` - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–µ—Ç–∫–∏
- `commit_changes(repo_path, message)` - –∫–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `push_branch(repo_path, branch)` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- `get_current_branch(repo_path)` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–∏
- `get_commit_hash(repo_path)` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ö–µ—à–∞ –∫–æ–º–º–∏—Ç–∞

–í—Å–µ —ç—Ç–æ –±—É–¥–µ—Ç **–≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ** –∏ **–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ**!

## üôè –°–ø–∞—Å–∏–±–æ

**–°–ø–∞—Å–∏–±–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∑–∞ –æ—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å!**
–≠—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç–æ, —á—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è code review - –Ω–∞—à–ª–∏ –º–µ—Å—Ç–æ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

–°–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º SOLID –¥–µ–ª–∞–µ—Ç –∫–æ–¥:
- –ß–∏—â–µ
- –ü–æ–Ω—è—Ç–Ω–µ–µ
- –õ–µ–≥—á–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å
- –õ–µ–≥—á–µ —Ä–∞—Å—à–∏—Ä—è—Ç—å

---

**–ê–≤—Ç–æ—Ä:** AI Assistant
**–î–∞—Ç–∞:** 11 –Ω–æ—è–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è:** 1.0


